"use strict";exports.id=938,exports.ids=[938],exports.modules={15616:(e,s,t)=>{t.d(s,{T:()=>i});var a=t(60687),r=t(43210),l=t(96241);let i=r.forwardRef(({className:e,...s},t)=>(0,a.jsx)("textarea",{className:(0,l.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:t,...s}));i.displayName="Textarea"},15938:(e,s,t)=>{t.d(s,{default:()=>b});var a=t(60687),r=t(43210),l=t(16189),i=t(24934),n=t(86287),d=t(85910),c=t(72840),o=t(28559),m=t(79410),x=t(40228),h=t(48730),p=t(27586),u=t(82657),j=t(52581),f=t(59821),g=t(63974),N=t(61470),v=t(47606),y=t(83580);function b({apartmentId:e}){let s=(0,l.useRouter)(),[t,b]=(0,r.useState)(null),[w,C]=(0,r.useState)(!0),[S,P]=(0,r.useState)(""),[A,k]=(0,r.useState)(!1),[D,F]=(0,r.useState)(""),[T,R]=(0,r.useState)(!1),[L,$]=(0,r.useState)(!1),I=async s=>{if(t)try{R(!0);let t=await u.WG.updateApartment(e,{status:s});b(t),j.o.success(`Apartment status updated to ${s}`)}catch(e){console.error("Failed to update apartment status:",e),j.o.error("Failed to update apartment status")}finally{R(!1)}};return!L||w?(0,a.jsxs)("div",{className:"flex min-h-screen flex-col pb-16 items-center justify-center",children:[(0,a.jsx)("div",{className:"text-center py-12",children:(0,a.jsx)("p",{className:"text-muted-foreground",children:"Loading apartment details..."})}),(0,a.jsx)(p.A,{})]}):S||!t?(0,a.jsxs)("div",{className:"flex min-h-screen flex-col pb-16 items-center justify-center",children:[(0,a.jsxs)("div",{className:"text-center py-12",children:[A?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"flex justify-center mb-4",children:(0,a.jsx)(c.A,{className:"h-12 w-12 text-red-500"})}),(0,a.jsx)("p",{className:"text-red-500 font-medium text-lg mb-2",children:"Access Denied"}),(0,a.jsx)("p",{className:"text-muted-foreground mb-4",children:"You don't have permission to view this apartment."})]}):(0,a.jsx)("p",{className:"text-red-500",children:S||"Apartment not found"}),(0,a.jsx)(i.$,{className:"mt-4",onClick:()=>s.push("/projects"),children:"Back to Projects"})]}),(0,a.jsx)(p.A,{})]}):(0,a.jsxs)("div",{className:"flex min-h-screen flex-col pb-16",children:[(0,a.jsxs)("div",{className:"flex items-center p-4 border-b",children:[(0,a.jsx)(i.$,{variant:"ghost",size:"icon",className:"mr-2",onClick:()=>s.back(),children:(0,a.jsx)(o.A,{className:"h-5 w-5"})}),(0,a.jsx)("h1",{className:"text-xl font-bold",children:"Apartment Details"})]}),(0,a.jsxs)("div",{className:"p-4 border-b",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[(0,a.jsx)(m.A,{className:"h-5 w-5"}),t.name]}),t.description&&(0,a.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:t.description})]}),(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsx)(f.E,{className:(e=>{switch(e){case"Not Started":default:return"bg-gray-500";case"In Progress":return"bg-blue-500";case"Completed":return"bg-green-500"}})(t.status),children:t.status})})]}),(0,a.jsx)("div",{className:"mt-4 p-3 border rounded-md bg-muted/30",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-sm font-medium",children:"Apartment Status:"}),(0,a.jsx)("div",{className:"w-48",children:(0,a.jsxs)(g.l6,{value:t.status,onValueChange:I,disabled:T,children:[(0,a.jsx)(g.bq,{className:"h-8",children:(0,a.jsx)(g.yv,{placeholder:"Select status"})}),(0,a.jsxs)(g.gC,{children:[(0,a.jsx)(g.eb,{value:"Not Started",children:"Not Started"}),(0,a.jsx)(g.eb,{value:"In Progress",children:"In Progress"}),(0,a.jsx)(g.eb,{value:"Completed",children:"Completed"})]})]})})]})}),(0,a.jsxs)("div",{className:"mt-4 space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsx)("span",{children:"Progress"}),(0,a.jsxs)("span",{children:[t.progress,"%"]})]}),(0,a.jsx)(n.k,{value:t.progress,className:"h-2"})]}),(0,a.jsxs)("div",{className:"flex justify-between mt-4",children:[(0,a.jsxs)("div",{className:"flex items-center text-sm text-muted-foreground",children:[(0,a.jsx)(x.A,{className:"h-4 w-4 mr-1"}),(0,a.jsxs)("span",{children:["Created: ",new Date(t.createdAt).toLocaleDateString()]})]}),(0,a.jsxs)("div",{className:"flex items-center text-sm text-muted-foreground",children:[(0,a.jsx)(h.A,{className:"h-4 w-4 mr-1"}),(0,a.jsxs)("span",{children:["#",t.number]})]})]})]}),(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsxs)(d.Tabs,{defaultValue:"progress",className:"w-full",children:[(0,a.jsxs)(d.TabsList,{className:"grid w-full grid-cols-3",children:[(0,a.jsx)(d.TabsTrigger,{value:"progress",children:"Project Progress"}),(0,a.jsx)(d.TabsTrigger,{value:"notes",children:"Site Notes"}),(0,a.jsx)(d.TabsTrigger,{value:"instructions",children:"Field Instructions"})]}),(0,a.jsx)(d.TabsContent,{value:"progress",className:"p-4",children:(0,a.jsx)(y.default,{apartmentId:e})}),(0,a.jsx)(d.TabsContent,{value:"notes",className:"p-4",children:(0,a.jsx)(N.default,{apartmentId:e})}),(0,a.jsx)(d.TabsContent,{value:"instructions",className:"p-4",children:(0,a.jsx)(v.default,{apartmentId:e})})]})}),(0,a.jsx)(p.A,{})]})}},33135:(e,s,t)=>{t.d(s,{AM:()=>n,Wv:()=>d,hl:()=>c});var a=t(60687),r=t(43210),l=t(40599),i=t(96241);let n=l.bL,d=l.l9,c=r.forwardRef(({className:e,align:s="center",sideOffset:t=4,...r},n)=>(0,a.jsx)(l.ZL,{children:(0,a.jsx)(l.UC,{ref:n,align:s,sideOffset:t,className:(0,i.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r})}));c.displayName=l.UC.displayName},37826:(e,s,t)=>{t.d(s,{Cf:()=>x,L3:()=>p,c7:()=>h,lG:()=>d,rr:()=>u,zM:()=>c});var a=t(60687),r=t(43210),l=t(26134),i=t(11860),n=t(96241);let d=l.bL,c=l.l9,o=l.ZL;l.bm;let m=r.forwardRef(({className:e,...s},t)=>(0,a.jsx)(l.hJ,{ref:t,className:(0,n.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...s}));m.displayName=l.hJ.displayName;let x=r.forwardRef(({className:e,children:s,...t},r)=>(0,a.jsxs)(o,{children:[(0,a.jsx)(m,{}),(0,a.jsxs)(l.UC,{ref:r,className:(0,n.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...t,children:[s,(0,a.jsxs)(l.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,a.jsx)(i.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]}));x.displayName=l.UC.displayName;let h=({className:e,...s})=>(0,a.jsx)("div",{className:(0,n.cn)("flex flex-col space-y-1.5 text-center sm:text-left",e),...s});h.displayName="DialogHeader";let p=r.forwardRef(({className:e,...s},t)=>(0,a.jsx)(l.hE,{ref:t,className:(0,n.cn)("text-lg font-semibold leading-none tracking-tight",e),...s}));p.displayName=l.hE.displayName;let u=r.forwardRef(({className:e,...s},t)=>(0,a.jsx)(l.VY,{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",e),...s}));u.displayName=l.VY.displayName},39390:(e,s,t)=>{t.d(s,{J:()=>c});var a=t(60687),r=t(43210),l=t(78148),i=t(24224),n=t(96241);let d=(0,i.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=r.forwardRef(({className:e,...s},t)=>(0,a.jsx)(l.b,{ref:t,className:(0,n.cn)(d(),e),...s}));c.displayName=l.b.displayName},47606:(e,s,t)=>{t.d(s,{default:()=>R});var a=t(60687),r=t(43210),l=t(24934),i=t(55192),n=t(59821),d=t(96474),c=t(10022),o=t(97992),m=t(58869),x=t(40228),h=t(13861),p=t(37826),u=t(85650),j=t(68988),f=t(15616),g=t(39390),N=t(63974),v=t(56924),y=t(33135),b=t(88233),w=t(11860),C=t(96241),S=t(52581),P=t(11314);let A=["Construction Task","Installation","Repair/Maintenance","Inspection","Safety Protocol","Quality Control","Material Handling","Equipment Operation","Other"],k=[{value:"low",label:"Low",color:"bg-green-100 text-green-800"},{value:"medium",label:"Medium",color:"bg-yellow-100 text-yellow-800"},{value:"high",label:"High",color:"bg-red-100 text-red-800"},{value:"urgent",label:"Urgent",color:"bg-red-600 text-white"}];function D({apartmentId:e,onSuccess:s,onCancel:t}){let[i,n]=(0,r.useState)(!1),[c,o]=(0,r.useState)(""),[m,h]=(0,r.useState)(""),[p,D]=(0,r.useState)("medium"),[F,T]=(0,r.useState)(""),[R,L]=(0,r.useState)(""),[$,I]=(0,r.useState)(""),[E,W]=(0,r.useState)(void 0),[J,O]=(0,r.useState)(""),[z,M]=(0,r.useState)(""),[U,q]=(0,r.useState)(""),[G,_]=(0,r.useState)([]),[V,Z]=(0,r.useState)([]),[B,H]=(0,r.useState)([]),Y=e=>{Z(s=>s.filter((s,t)=>t!==e)),H(s=>{let t=s.filter((s,t)=>t!==e);return URL.revokeObjectURL(s[e]),t})},K=(e,s)=>{_(t=>t.map(t=>t.id===e?{...t,description:s}:t))},Q=e=>{_(s=>s.filter(s=>s.id!==e).map((e,s)=>({...e,order:s+1})))},X=async t=>{if(t.preventDefault(),!c.trim()){S.o.error("Please enter a title");return}if(!m){S.o.error("Please select an instruction type");return}if(!F.trim()){S.o.error("Please enter a description");return}if(0===G.length){S.o.error("Please add at least one step");return}let a=G.filter(e=>e.description.trim());if(a.length!==G.length){S.o.error("Please fill in all step descriptions");return}try{n(!0);let t=new FormData;t.append("title",c.trim()),t.append("instructionType",m),t.append("priority",p),t.append("description",F.trim()),t.append("location",R.trim()),t.append("assignedTo",$.trim()),E&&t.append("dueDate",E.toISOString()),t.append("materials",J.trim()),t.append("tools",z.trim()),t.append("safetyNotes",U.trim()),t.append("steps",JSON.stringify(a)),V.forEach((e,s)=>{t.append("photos",e)}),await P.C.createFieldInstruction(e,t),S.o.success("Field instruction created successfully"),s()}catch(e){console.error("Failed to create field instruction:",e),S.o.error("Failed to create field instruction")}finally{n(!1)}};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Create Field Instruction"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Create detailed instructions for field work tasks."})]}),(0,a.jsxs)("form",{onSubmit:X,className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g.J,{htmlFor:"title",children:"Title"}),(0,a.jsx)(j.p,{id:"title",value:c,onChange:e=>o(e.target.value),placeholder:"Brief title for the instruction",required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g.J,{htmlFor:"instructionType",children:"Instruction Type"}),(0,a.jsxs)(N.l6,{value:m,onValueChange:h,children:[(0,a.jsx)(N.bq,{children:(0,a.jsx)(N.yv,{placeholder:"Select instruction type"})}),(0,a.jsx)(N.gC,{children:A.map(e=>(0,a.jsx)(N.eb,{value:e,children:e},e))})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g.J,{htmlFor:"priority",children:"Priority"}),(0,a.jsxs)(N.l6,{value:p,onValueChange:D,children:[(0,a.jsx)(N.bq,{children:(0,a.jsx)(N.yv,{})}),(0,a.jsx)(N.gC,{children:k.map(e=>(0,a.jsx)(N.eb,{value:e.value,children:(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsx)("span",{className:`px-2 py-1 rounded text-xs ${e.color}`,children:e.label})})},e.value))})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g.J,{htmlFor:"location",children:"Location"}),(0,a.jsx)(j.p,{id:"location",value:R,onChange:e=>L(e.target.value),placeholder:"e.g., Kitchen, Bathroom, Exterior"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g.J,{htmlFor:"assignedTo",children:"Assigned To"}),(0,a.jsx)(j.p,{id:"assignedTo",value:$,onChange:e=>I(e.target.value),placeholder:"Worker name or team"})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g.J,{htmlFor:"description",children:"Description"}),(0,a.jsx)(f.T,{id:"description",value:F,onChange:e=>T(e.target.value),placeholder:"Detailed description of the work to be done...",rows:3,required:!0})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g.J,{htmlFor:"materials",children:"Required Materials"}),(0,a.jsx)(f.T,{id:"materials",value:J,onChange:e=>O(e.target.value),placeholder:"List required materials...",rows:2})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g.J,{htmlFor:"tools",children:"Required Tools"}),(0,a.jsx)(f.T,{id:"tools",value:z,onChange:e=>M(e.target.value),placeholder:"List required tools...",rows:2})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g.J,{htmlFor:"safetyNotes",children:"Safety Notes"}),(0,a.jsx)(f.T,{id:"safetyNotes",value:U,onChange:e=>q(e.target.value),placeholder:"Important safety considerations...",rows:2})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g.J,{children:"Due Date (Optional)"}),(0,a.jsxs)(y.AM,{children:[(0,a.jsx)(y.Wv,{asChild:!0,children:(0,a.jsxs)(l.$,{variant:"outline",className:(0,C.cn)("w-full justify-start text-left font-normal",!E&&"text-muted-foreground"),children:[(0,a.jsx)(x.A,{className:"mr-2 h-4 w-4"}),E?(0,u.GP)(E,"PPP"):"Select due date"]})}),(0,a.jsx)(y.hl,{className:"w-auto p-0",children:(0,a.jsx)(v.V,{mode:"single",selected:E,onSelect:W,initialFocus:!0})})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(g.J,{children:"Work Steps"}),(0,a.jsxs)(l.$,{type:"button",size:"sm",onClick:()=>{let e={id:Date.now().toString(),description:"",order:G.length+1};_(s=>[...s,e])},children:[(0,a.jsx)(d.A,{className:"h-4 w-4 mr-1"}),"Add Step"]})]}),0===G.length?(0,a.jsxs)("div",{className:"text-center py-4 border-2 border-dashed border-gray-300 rounded-lg",children:[(0,a.jsx)("p",{className:"text-gray-500",children:"No steps added yet"}),(0,a.jsx)("p",{className:"text-sm text-gray-400",children:'Click "Add Step" to create work instructions'})]}):(0,a.jsx)("div",{className:"space-y-3",children:G.map((e,s)=>(0,a.jsxs)("div",{className:"flex items-start gap-3 p-3 border rounded-lg",children:[(0,a.jsx)("div",{className:"flex-shrink-0 w-8 h-8 bg-primary text-primary-foreground rounded-full flex items-center justify-center text-sm font-medium",children:e.order}),(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)(f.T,{value:e.description,onChange:s=>K(e.id,s.target.value),placeholder:`Step ${e.order}: Describe what needs to be done...`,rows:2,className:"resize-none"})}),(0,a.jsx)(l.$,{type:"button",size:"sm",variant:"outline",onClick:()=>Q(e.id),className:"flex-shrink-0",children:(0,a.jsx)(b.A,{className:"h-4 w-4"})})]},e.id))})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g.J,{children:"Reference Photos (Optional)"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(j.p,{type:"file",accept:"image/*",multiple:!0,onChange:e=>{let s=Array.from(e.target.files||[]),t=s.filter(e=>e.type.startsWith("image/"));if(t.length!==s.length){S.o.error("Please select only image files");return}if(V.length+t.length>5){S.o.error("Maximum 5 photos allowed");return}Z(e=>[...e,...t]),t.forEach(e=>{let s=URL.createObjectURL(e);H(e=>[...e,s])})},className:"flex-1"}),(0,a.jsxs)("span",{className:"text-sm text-muted-foreground",children:[V.length,"/5"]})]}),B.length>0&&(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:B.map((e,s)=>(0,a.jsxs)("div",{className:"relative group",children:[(0,a.jsx)("img",{src:e,alt:`Instruction photo ${s+1}`,className:"w-full h-24 object-cover rounded-md"}),(0,a.jsx)(l.$,{type:"button",size:"sm",variant:"destructive",className:"absolute top-1 right-1 opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>Y(s),children:(0,a.jsx)(w.A,{className:"h-3 w-3"})})]},s))})]})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-2 pt-4",children:[(0,a.jsx)(l.$,{type:"button",variant:"outline",onClick:t,children:"Cancel"}),(0,a.jsx)(l.$,{type:"submit",disabled:i,children:i?"Creating...":"Create Instruction"})]})]})]})}let F={low:"bg-green-100 text-green-800",medium:"bg-yellow-100 text-yellow-800",high:"bg-red-100 text-red-800",urgent:"bg-red-600 text-white"},T={Created:"bg-gray-100 text-gray-800","Work Started":"bg-blue-100 text-blue-800",Completed:"bg-green-100 text-green-800"};function R({apartmentId:e}){let[s,t]=(0,r.useState)([]),[j,f]=(0,r.useState)(!0),[g,N]=(0,r.useState)(""),[v,y]=(0,r.useState)(!1),[b,w]=(0,r.useState)(null),[C,A]=(0,r.useState)(!1),k=async()=>{try{f(!0),N("");let s=await P.C.getFieldInstructions(e);t(s)}catch(e){console.error("Failed to fetch field instructions:",e),N(e?.response?.data?.message||"Failed to load field instructions"),S.o.error("Failed to load field instructions")}finally{f(!1)}},R=e=>{w(e),A(!0)};if(j)return(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Field Instructions"}),(0,a.jsxs)(l.$,{disabled:!0,children:[(0,a.jsx)(d.A,{className:"h-4 w-4 mr-2"}),"Create Instruction"]})]}),(0,a.jsx)("div",{className:"grid gap-4",children:[1,2,3].map(e=>(0,a.jsx)(i.Zp,{className:"animate-pulse",children:(0,a.jsxs)(i.Wu,{className:"p-4",children:[(0,a.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/3 mb-2"}),(0,a.jsx)("div",{className:"h-3 bg-gray-200 rounded w-1/2"})]})},e))})]});if(g)return(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Field Instructions"}),(0,a.jsxs)(l.$,{onClick:k,children:[(0,a.jsx)(d.A,{className:"h-4 w-4 mr-2"}),"Create Instruction"]})]}),(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("p",{className:"text-red-500 mb-4",children:g}),(0,a.jsx)(l.$,{onClick:k,variant:"outline",children:"Try Again"})]})]});let L=s.filter(e=>"urgent"===e.priority||"high"===e.priority),$=(()=>{let e=new Date;return s.filter(s=>s.dueDate&&new Date(s.dueDate)<e&&"Completed"!==s.status)})();return(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Field Instructions"}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:[s.length," instructions • ",L.length," urgent • ",$.length," overdue"]})]}),(0,a.jsxs)(p.lG,{open:v,onOpenChange:y,children:[(0,a.jsx)(p.zM,{asChild:!0,children:(0,a.jsxs)(l.$,{children:[(0,a.jsx)(d.A,{className:"h-4 w-4 mr-2"}),"Create Instruction"]})}),(0,a.jsxs)(p.Cf,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[(0,a.jsx)(p.c7,{children:(0,a.jsx)(p.L3,{children:"Create Field Instruction"})}),(0,a.jsx)(D,{apartmentId:e,onSuccess:()=>{y(!1),k()},onCancel:()=>y(!1)})]})]})]}),s.length>0&&(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-2",children:[(0,a.jsxs)("div",{className:"bg-gray-50 p-3 rounded-lg",children:[(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"Created"}),(0,a.jsx)("div",{className:"text-lg font-semibold text-gray-800",children:s.filter(e=>"Created"===e.status).length})]}),(0,a.jsxs)("div",{className:"bg-blue-50 p-3 rounded-lg",children:[(0,a.jsx)("div",{className:"text-sm text-blue-600",children:"Work Started"}),(0,a.jsx)("div",{className:"text-lg font-semibold text-blue-800",children:s.filter(e=>"Work Started"===e.status).length})]}),(0,a.jsxs)("div",{className:"bg-green-50 p-3 rounded-lg",children:[(0,a.jsx)("div",{className:"text-sm text-green-600",children:"Completed"}),(0,a.jsx)("div",{className:"text-lg font-semibold text-green-800",children:s.filter(e=>"Completed"===e.status).length})]})]}),0===s.length?(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(c.A,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-500 mb-4",children:"No field instructions yet"}),(0,a.jsx)("p",{className:"text-sm text-gray-400",children:"Create detailed work instructions for your team"})]}):(0,a.jsx)("div",{className:"space-y-4",children:s.map(e=>(0,a.jsxs)(i.Zp,{className:"hover:shadow-md transition-shadow",children:[(0,a.jsx)(i.aR,{className:"pb-3",children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsx)(i.ZB,{className:"text-base",children:e.title}),(0,a.jsx)(n.E,{className:F[e.priority],children:e.priority}),(0,a.jsx)(n.E,{className:T[e.status],children:e.status})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[(0,a.jsx)(c.A,{className:"h-3 w-3"}),e.instructionType]}),(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[(0,a.jsx)(o.A,{className:"h-3 w-3"}),e.location||"No location"]}),e.assignedTo&&(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[(0,a.jsx)(m.A,{className:"h-3 w-3"}),e.assignedTo]}),e.dueDate&&(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[(0,a.jsx)(x.A,{className:"h-3 w-3"}),(0,u.GP)(new Date(e.dueDate),"MMM dd")]})]}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground mt-2 line-clamp-2",children:e.description})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)(n.E,{variant:"outline",children:[e.steps?.length||0," steps"]}),e.images?.length>0&&(0,a.jsxs)(n.E,{variant:"outline",children:[e.images.length," photos"]})]})]})}),(0,a.jsx)(i.Wu,{className:"pt-0",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Created ",(0,u.GP)(new Date(e.createdAt),"PPp")]}),(0,a.jsxs)(l.$,{size:"sm",variant:"outline",onClick:()=>R(e),children:[(0,a.jsx)(h.A,{className:"h-4 w-4 mr-1"}),"View Details"]})]})})]},e._id))}),(0,a.jsx)(p.lG,{open:C,onOpenChange:A,children:(0,a.jsxs)(p.Cf,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[(0,a.jsx)(p.c7,{children:(0,a.jsx)(p.L3,{children:"Field Instruction Details"})}),b&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-semibold text-lg",children:b.title}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:b.instructionType})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(n.E,{className:F[b.priority],children:b.priority}),(0,a.jsx)(n.E,{className:T[b.status],children:b.status})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Location:"})," ",b.location||"Not specified"]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Assigned To:"})," ",b.assignedTo||"Not assigned"]}),b.dueDate&&(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Due Date:"})," ",(0,u.GP)(new Date(b.dueDate),"PPP")]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Created:"})," ",(0,u.GP)(new Date(b.createdAt),"PPP")]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h5",{className:"font-medium mb-2",children:"Description"}),(0,a.jsx)("p",{className:"text-sm whitespace-pre-wrap",children:b.description})]}),b.materials&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h5",{className:"font-medium mb-2",children:"Required Materials"}),(0,a.jsx)("p",{className:"text-sm whitespace-pre-wrap",children:b.materials})]}),b.tools&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h5",{className:"font-medium mb-2",children:"Required Tools"}),(0,a.jsx)("p",{className:"text-sm whitespace-pre-wrap",children:b.tools})]}),b.safetyNotes&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h5",{className:"font-medium mb-2",children:"Safety Notes"}),(0,a.jsx)("p",{className:"text-sm whitespace-pre-wrap text-red-600",children:b.safetyNotes})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h5",{className:"font-medium mb-3",children:["Work Steps (",b.steps?.length||0,")"]}),(0,a.jsx)("div",{className:"space-y-3",children:b.steps?.map(e=>a.jsxs("div",{className:"flex items-start gap-3 p-3 border rounded-lg",children:[a.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-primary text-primary-foreground rounded-full flex items-center justify-center text-sm font-medium",children:e.order}),a.jsx("div",{className:"flex-1",children:a.jsx("p",{className:"text-sm",children:e.description})})]},e.id))||(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"No steps defined"})})]}),b.images.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("h5",{className:"font-medium mb-2",children:["Reference Photos (",b.images.length,")"]}),(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:b.images.map((e,s)=>(0,a.jsx)("img",{src:e.url,alt:`Instruction photo ${s+1}`,className:"w-full h-32 object-cover rounded-md"},s))})]})]})]})})]})}},55192:(e,s,t)=>{t.d(s,{BT:()=>c,Wu:()=>o,ZB:()=>d,Zp:()=>i,aR:()=>n,wL:()=>m});var a=t(60687),r=t(43210),l=t(96241);let i=r.forwardRef(({className:e,...s},t)=>(0,a.jsx)("div",{ref:t,className:(0,l.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...s}));i.displayName="Card";let n=r.forwardRef(({className:e,...s},t)=>(0,a.jsx)("div",{ref:t,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",e),...s}));n.displayName="CardHeader";let d=r.forwardRef(({className:e,...s},t)=>(0,a.jsx)("div",{ref:t,className:(0,l.cn)("text-2xl font-semibold leading-none tracking-tight",e),...s}));d.displayName="CardTitle";let c=r.forwardRef(({className:e,...s},t)=>(0,a.jsx)("div",{ref:t,className:(0,l.cn)("text-sm text-muted-foreground",e),...s}));c.displayName="CardDescription";let o=r.forwardRef(({className:e,...s},t)=>(0,a.jsx)("div",{ref:t,className:(0,l.cn)("p-6 pt-0",e),...s}));o.displayName="CardContent";let m=r.forwardRef(({className:e,...s},t)=>(0,a.jsx)("div",{ref:t,className:(0,l.cn)("flex items-center p-6 pt-0",e),...s}));m.displayName="CardFooter"},56924:(e,s,t)=>{t.d(s,{V:()=>c});var a=t(60687);t(43210);var r=t(47033),l=t(14952),i=t(61109),n=t(96241),d=t(24934);function c({className:e,classNames:s,showOutsideDays:t=!0,...c}){return(0,a.jsx)(i.hv,{showOutsideDays:t,className:(0,n.cn)("p-3",e),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:(0,n.cn)((0,d.r)({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:(0,n.cn)((0,d.r)({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...s},components:{IconLeft:({...e})=>(0,a.jsx)(r.A,{className:"h-4 w-4"}),IconRight:({...e})=>(0,a.jsx)(l.A,{className:"h-4 w-4"})},...c})}c.displayName="Calendar"},61470:(e,s,t)=>{t.d(s,{default:()=>D});var a=t(60687),r=t(43210),l=t(24934),i=t(55192),n=t(59821),d=t(96474),c=t(10022),o=t(97992),m=t(13861),x=t(37826),h=t(85650),p=t(68988),u=t(15616),j=t(39390),f=t(63974),g=t(56924),N=t(33135),v=t(40228),y=t(11860),b=t(96241),w=t(52581),C=t(57027);let S=["General Observation","Issue/Problem","Safety Concern","Quality Check","Material Delivery","Equipment Issue","Weather Impact","Other"],P=[{value:"low",label:"Low",color:"bg-green-100 text-green-800"},{value:"medium",label:"Medium",color:"bg-yellow-100 text-yellow-800"},{value:"high",label:"High",color:"bg-red-100 text-red-800"},{value:"critical",label:"Critical",color:"bg-red-600 text-white"}];function A({apartmentId:e,onSuccess:s,onCancel:t}){let[i,n]=(0,r.useState)(!1),[d,c]=(0,r.useState)(new Date),[o,m]=(0,r.useState)(""),[x,A]=(0,r.useState)("medium"),[k,D]=(0,r.useState)(""),[F,T]=(0,r.useState)(""),[R,L]=(0,r.useState)(""),[$,I]=(0,r.useState)([]),[E,W]=(0,r.useState)([]),J=e=>{I(s=>s.filter((s,t)=>t!==e)),W(s=>{let t=s.filter((s,t)=>t!==e);return URL.revokeObjectURL(s[e]),t})},O=async t=>{if(t.preventDefault(),!o){w.o.error("Please select a note type");return}if(!k.trim()){w.o.error("Please enter a title");return}if(!F.trim()){w.o.error("Please enter a description");return}try{n(!0);let t=new FormData;t.append("date",d.toISOString()),t.append("noteType",o),t.append("priority",x),t.append("title",k.trim()),t.append("description",F.trim()),t.append("location",R.trim()),$.forEach((e,s)=>{t.append("photos",e)}),await C.F.createSiteNote(e,t),w.o.success("Site note created successfully"),s()}catch(e){console.error("Failed to create site note:",e),w.o.error("Failed to create site note")}finally{n(!1)}};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Add Site Note"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Log observations, issues, or important information about the site."})]}),(0,a.jsxs)("form",{onSubmit:O,className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(j.J,{htmlFor:"date",children:"Date"}),(0,a.jsxs)(N.AM,{children:[(0,a.jsx)(N.Wv,{asChild:!0,children:(0,a.jsxs)(l.$,{variant:"outline",className:(0,b.cn)("w-full justify-start text-left font-normal",!d&&"text-muted-foreground"),children:[(0,a.jsx)(v.A,{className:"mr-2 h-4 w-4"}),d?(0,h.GP)(d,"PPP"):"Select a date"]})}),(0,a.jsx)(N.hl,{className:"w-auto p-0",children:(0,a.jsx)(g.V,{mode:"single",selected:d,onSelect:e=>e&&c(e),initialFocus:!0})})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(j.J,{htmlFor:"noteType",children:"Note Type"}),(0,a.jsxs)(f.l6,{value:o,onValueChange:m,children:[(0,a.jsx)(f.bq,{children:(0,a.jsx)(f.yv,{placeholder:"Select note type"})}),(0,a.jsx)(f.gC,{children:S.map(e=>(0,a.jsx)(f.eb,{value:e,children:e},e))})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(j.J,{htmlFor:"priority",children:"Priority"}),(0,a.jsxs)(f.l6,{value:x,onValueChange:A,children:[(0,a.jsx)(f.bq,{children:(0,a.jsx)(f.yv,{})}),(0,a.jsx)(f.gC,{children:P.map(e=>(0,a.jsx)(f.eb,{value:e.value,children:(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsx)("span",{className:`px-2 py-1 rounded text-xs ${e.color}`,children:e.label})})},e.value))})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(j.J,{htmlFor:"location",children:"Location (Optional)"}),(0,a.jsx)(p.p,{id:"location",value:R,onChange:e=>L(e.target.value),placeholder:"e.g., Kitchen, Bathroom, Exterior"})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(j.J,{htmlFor:"title",children:"Title"}),(0,a.jsx)(p.p,{id:"title",value:k,onChange:e=>D(e.target.value),placeholder:"Brief title for the note",required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(j.J,{htmlFor:"description",children:"Description"}),(0,a.jsx)(u.T,{id:"description",value:F,onChange:e=>T(e.target.value),placeholder:"Detailed description of the observation or issue...",rows:4,required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(j.J,{children:"Photos (Optional)"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(p.p,{type:"file",accept:"image/*",multiple:!0,onChange:e=>{let s=Array.from(e.target.files||[]),t=s.filter(e=>e.type.startsWith("image/"));if(t.length!==s.length){w.o.error("Please select only image files");return}if($.length+t.length>5){w.o.error("Maximum 5 photos allowed");return}I(e=>[...e,...t]),t.forEach(e=>{let s=URL.createObjectURL(e);W(e=>[...e,s])})},className:"flex-1"}),(0,a.jsxs)("span",{className:"text-sm text-muted-foreground",children:[$.length,"/5"]})]}),E.length>0&&(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:E.map((e,s)=>(0,a.jsxs)("div",{className:"relative group",children:[(0,a.jsx)("img",{src:e,alt:`Site note photo ${s+1}`,className:"w-full h-24 object-cover rounded-md"}),(0,a.jsx)(l.$,{type:"button",size:"sm",variant:"destructive",className:"absolute top-1 right-1 opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>J(s),children:(0,a.jsx)(y.A,{className:"h-3 w-3"})})]},s))})]})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-2 pt-4",children:[(0,a.jsx)(l.$,{type:"button",variant:"outline",onClick:t,children:"Cancel"}),(0,a.jsx)(l.$,{type:"submit",disabled:i,children:i?"Creating...":"Create Note"})]})]})]})}let k={low:"bg-green-100 text-green-800",medium:"bg-yellow-100 text-yellow-800",high:"bg-red-100 text-red-800",critical:"bg-red-600 text-white"};function D({apartmentId:e}){let[s,t]=(0,r.useState)([]),[p,u]=(0,r.useState)(!0),[j,f]=(0,r.useState)(""),[g,N]=(0,r.useState)(!1),[v,y]=(0,r.useState)(null),[b,S]=(0,r.useState)(!1),P=async()=>{try{u(!0),f("");let s=await C.F.getSiteNotes(e);t(s)}catch(e){console.error("Failed to fetch site notes:",e),f(e?.response?.data?.message||"Failed to load site notes"),w.o.error("Failed to load site notes")}finally{u(!1)}},D=e=>{y(e),S(!0)},F=e=>{let t=s.filter(s=>s.priority===e).length;return console.log(`Priority count for "${e}":`,t,"Notes:",s.map(e=>e.priority)),t};if(p)return(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Site Notes"}),(0,a.jsxs)(l.$,{disabled:!0,children:[(0,a.jsx)(d.A,{className:"h-4 w-4 mr-2"}),"Add Note"]})]}),(0,a.jsx)("div",{className:"grid gap-4",children:[1,2,3].map(e=>(0,a.jsx)(i.Zp,{className:"animate-pulse",children:(0,a.jsxs)(i.Wu,{className:"p-4",children:[(0,a.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/3 mb-2"}),(0,a.jsx)("div",{className:"h-3 bg-gray-200 rounded w-1/2"})]})},e))})]});if(j)return(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Site Notes"}),(0,a.jsxs)(l.$,{onClick:P,children:[(0,a.jsx)(d.A,{className:"h-4 w-4 mr-2"}),"Add Note"]})]}),(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("p",{className:"text-red-500 mb-4",children:j}),(0,a.jsx)(l.$,{onClick:P,variant:"outline",children:"Try Again"})]})]});let T=s.filter(e=>"Critical"===e.priority||"High"===e.priority);return(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Site Notes"}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:[s.length," notes • ",T.length," high priority"]})]}),(0,a.jsxs)(x.lG,{open:g,onOpenChange:N,children:[(0,a.jsx)(x.zM,{asChild:!0,children:(0,a.jsxs)(l.$,{children:[(0,a.jsx)(d.A,{className:"h-4 w-4 mr-2"}),"Add Note"]})}),(0,a.jsxs)(x.Cf,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,a.jsx)(x.c7,{children:(0,a.jsx)(x.L3,{children:"Add Site Note"})}),(0,a.jsx)(A,{apartmentId:e,onSuccess:()=>{N(!1),P()},onCancel:()=>N(!1)})]})]})]}),s.length>0&&(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:[(0,a.jsxs)("div",{className:"bg-green-50 p-3 rounded-lg",children:[(0,a.jsx)("div",{className:"text-sm text-green-600",children:"Low"}),(0,a.jsx)("div",{className:"text-lg font-semibold text-green-800",children:F("Low")})]}),(0,a.jsxs)("div",{className:"bg-yellow-50 p-3 rounded-lg",children:[(0,a.jsx)("div",{className:"text-sm text-yellow-600",children:"Medium"}),(0,a.jsx)("div",{className:"text-lg font-semibold text-yellow-800",children:F("Medium")})]}),(0,a.jsxs)("div",{className:"bg-red-50 p-3 rounded-lg",children:[(0,a.jsx)("div",{className:"text-sm text-red-600",children:"High"}),(0,a.jsx)("div",{className:"text-lg font-semibold text-red-800",children:F("High")})]}),(0,a.jsxs)("div",{className:"bg-red-100 p-3 rounded-lg",children:[(0,a.jsx)("div",{className:"text-sm text-red-700",children:"Critical"}),(0,a.jsx)("div",{className:"text-lg font-semibold text-red-900",children:F("Critical")})]})]}),0===s.length?(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(c.A,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-500 mb-4",children:"No site notes yet"}),(0,a.jsx)("p",{className:"text-sm text-gray-400",children:"Start logging observations and issues"})]}):(0,a.jsx)("div",{className:"space-y-4",children:s.map(e=>(0,a.jsxs)(i.Zp,{className:"hover:shadow-md transition-shadow",children:[(0,a.jsx)(i.aR,{className:"pb-3",children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsx)(i.ZB,{className:"text-base",children:e.title}),(0,a.jsx)(n.E,{className:k[e.priority],children:e.priority})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[(0,a.jsx)(c.A,{className:"h-3 w-3"}),e.noteType]}),(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[(0,a.jsx)(o.A,{className:"h-3 w-3"}),e.location||"No location"]})]}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground mt-2 line-clamp-2",children:e.description})]}),(0,a.jsx)("div",{className:"flex items-center gap-2",children:e.images.length>0&&(0,a.jsxs)(n.E,{variant:"outline",children:[e.images.length," photos"]})})]})}),(0,a.jsx)(i.Wu,{className:"pt-0",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Created ",(0,h.GP)(new Date(e.createdAt),"PPp")]}),(0,a.jsxs)(l.$,{size:"sm",variant:"outline",onClick:()=>D(e),children:[(0,a.jsx)(m.A,{className:"h-4 w-4 mr-1"}),"View Details"]})]})})]},e._id))}),(0,a.jsx)(x.lG,{open:b,onOpenChange:S,children:(0,a.jsxs)(x.Cf,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,a.jsx)(x.c7,{children:(0,a.jsx)(x.L3,{children:"Site Note Details"})}),v&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-semibold",children:v.title}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:(0,h.GP)(new Date(v.createdAt),"PPP")})]}),(0,a.jsx)(n.E,{className:k[v.priority],children:v.priority})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Type:"})," ",v.noteType]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Location:"})," ",v.location||"Not specified"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h5",{className:"font-medium mb-2",children:"Description"}),(0,a.jsx)("p",{className:"text-sm whitespace-pre-wrap",children:v.description})]}),v.images.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("h5",{className:"font-medium mb-2",children:["Photos (",v.images.length,")"]}),(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:v.images.map((e,s)=>(0,a.jsx)("img",{src:e.url,alt:`Site note photo ${s+1}`,className:"w-full h-32 object-cover rounded-md"},s))})]})]})]})})]})}},63974:(e,s,t)=>{t.d(s,{bq:()=>x,eb:()=>j,gC:()=>u,l6:()=>o,yv:()=>m});var a=t(60687),r=t(43210),l=t(97822),i=t(78272),n=t(3589),d=t(13964),c=t(96241);let o=l.bL;l.YJ;let m=l.WT,x=r.forwardRef(({className:e,children:s,...t},r)=>(0,a.jsxs)(l.l9,{ref:r,className:(0,c.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...t,children:[s,(0,a.jsx)(l.In,{asChild:!0,children:(0,a.jsx)(i.A,{className:"h-4 w-4 opacity-50"})})]}));x.displayName=l.l9.displayName;let h=r.forwardRef(({className:e,...s},t)=>(0,a.jsx)(l.PP,{ref:t,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",e),...s,children:(0,a.jsx)(n.A,{className:"h-4 w-4"})}));h.displayName=l.PP.displayName;let p=r.forwardRef(({className:e,...s},t)=>(0,a.jsx)(l.wn,{ref:t,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",e),...s,children:(0,a.jsx)(i.A,{className:"h-4 w-4"})}));p.displayName=l.wn.displayName;let u=r.forwardRef(({className:e,children:s,position:t="popper",...r},i)=>(0,a.jsx)(l.ZL,{children:(0,a.jsxs)(l.UC,{ref:i,className:(0,c.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===t&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:t,...r,children:[(0,a.jsx)(h,{}),(0,a.jsx)(l.LM,{className:(0,c.cn)("p-1","popper"===t&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),(0,a.jsx)(p,{})]})}));u.displayName=l.UC.displayName,r.forwardRef(({className:e,...s},t)=>(0,a.jsx)(l.JU,{ref:t,className:(0,c.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...s})).displayName=l.JU.displayName;let j=r.forwardRef(({className:e,children:s,...t},r)=>(0,a.jsxs)(l.q7,{ref:r,className:(0,c.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...t,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(l.VF,{children:(0,a.jsx)(d.A,{className:"h-4 w-4"})})}),(0,a.jsx)(l.p4,{children:s})]}));j.displayName=l.q7.displayName,r.forwardRef(({className:e,...s},t)=>(0,a.jsx)(l.wv,{ref:t,className:(0,c.cn)("-mx-1 my-1 h-px bg-muted",e),...s})).displayName=l.wv.displayName},68988:(e,s,t)=>{t.d(s,{p:()=>i});var a=t(60687),r=t(43210),l=t(96241);let i=r.forwardRef(({className:e,type:s,...t},r)=>(0,a.jsx)("input",{type:s,className:(0,l.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:r,...t}));i.displayName="Input"},83580:(e,s,t)=>{t.d(s,{default:()=>S});var a=t(60687),r=t(43210),l=t(24934),i=t(55192),n=t(59821),d=t(96474),c=t(40228),o=t(48730),m=t(9005),x=t(13861),h=t(37826),p=t(85650),u=t(68988),j=t(15616),f=t(39390),g=t(56924),N=t(33135),v=t(11860),y=t(96241),b=t(52581),w=t(20971);function C({apartmentId:e,onSuccess:s,onCancel:t}){let[i,n]=(0,r.useState)(!1),[d,o]=(0,r.useState)(new Date),[m,x]=(0,r.useState)(""),[h,C]=(0,r.useState)(8),[S,P]=(0,r.useState)([]),[A,k]=(0,r.useState)([]),D=e=>{P(s=>s.filter((s,t)=>t!==e)),k(s=>{let t=s.filter((s,t)=>t!==e);return URL.revokeObjectURL(s[e]),t})},F=async t=>{if(t.preventDefault(),!m.trim()){b.o.error("Please enter a work description");return}if(h<=0||h>24){b.o.error("Please enter valid hours worked (1-24)");return}try{n(!0);let t=new FormData;t.append("date",d.toISOString()),t.append("workDescription",m.trim()),t.append("hoursWorked",h.toString()),S.forEach((e,s)=>{t.append("photos",e)}),await w.L.createProgressEntry(e,t),b.o.success("Progress entry created successfully"),s()}catch(e){console.error("Failed to create progress entry:",e),b.o.error("Failed to create progress entry")}finally{n(!1)}};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Add Daily Progress Entry"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Log your daily work progress with photos and descriptions."})]}),(0,a.jsxs)("form",{onSubmit:F,className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(f.J,{htmlFor:"date",children:"Date"}),(0,a.jsxs)(N.AM,{children:[(0,a.jsx)(N.Wv,{asChild:!0,children:(0,a.jsxs)(l.$,{variant:"outline",className:(0,y.cn)("w-full justify-start text-left font-normal",!d&&"text-muted-foreground"),children:[(0,a.jsx)(c.A,{className:"mr-2 h-4 w-4"}),d?(0,p.GP)(d,"PPP"):"Select a date"]})}),(0,a.jsx)(N.hl,{className:"w-auto p-0",children:(0,a.jsx)(g.V,{mode:"single",selected:d,onSelect:e=>e&&o(e),initialFocus:!0})})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(f.J,{htmlFor:"hoursWorked",children:"Hours Worked"}),(0,a.jsx)(u.p,{id:"hoursWorked",type:"number",min:"0.5",max:"24",step:"0.5",value:h,onChange:e=>C(parseFloat(e.target.value)||0),placeholder:"8"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(f.J,{htmlFor:"workDescription",children:"Work Description"}),(0,a.jsx)(j.T,{id:"workDescription",value:m,onChange:e=>x(e.target.value),placeholder:"Describe the work completed today...",rows:4,required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(f.J,{children:"Photos (Optional)"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(u.p,{type:"file",accept:"image/*",multiple:!0,onChange:e=>{let s=Array.from(e.target.files||[]),t=s.filter(e=>e.type.startsWith("image/"));if(t.length!==s.length){b.o.error("Please select only image files");return}if(S.length+t.length>10){b.o.error("Maximum 10 photos allowed");return}P(e=>[...e,...t]),t.forEach(e=>{let s=URL.createObjectURL(e);k(e=>[...e,s])})},className:"flex-1"}),(0,a.jsxs)("span",{className:"text-sm text-muted-foreground",children:[S.length,"/10"]})]}),A.length>0&&(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:A.map((e,s)=>(0,a.jsxs)("div",{className:"relative group",children:[(0,a.jsx)("img",{src:e,alt:`Progress photo ${s+1}`,className:"w-full h-24 object-cover rounded-md"}),(0,a.jsx)(l.$,{type:"button",size:"sm",variant:"destructive",className:"absolute top-1 right-1 opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>D(s),children:(0,a.jsx)(v.A,{className:"h-3 w-3"})})]},s))})]})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-2 pt-4",children:[(0,a.jsx)(l.$,{type:"button",variant:"outline",onClick:t,children:"Cancel"}),(0,a.jsx)(l.$,{type:"submit",disabled:i,children:i?"Creating...":"Create Entry"})]})]})]})}function S({apartmentId:e}){let[s,t]=(0,r.useState)([]),[u,j]=(0,r.useState)(!0),[f,g]=(0,r.useState)(""),[N,v]=(0,r.useState)(!1),[y,S]=(0,r.useState)(null),[P,A]=(0,r.useState)(!1),k=async()=>{try{j(!0),g("");let s=await w.L.getProgressEntries(e);t(s)}catch(e){console.error("Failed to fetch progress entries:",e),g(e?.response?.data?.message||"Failed to load progress entries"),b.o.error("Failed to load progress entries")}finally{j(!1)}},D=e=>{S(e),A(!0)};return u?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Project Progress"}),(0,a.jsxs)(l.$,{disabled:!0,children:[(0,a.jsx)(d.A,{className:"h-4 w-4 mr-2"}),"Add Entry"]})]}),(0,a.jsx)("div",{className:"grid gap-4",children:[1,2,3].map(e=>(0,a.jsx)(i.Zp,{className:"animate-pulse",children:(0,a.jsxs)(i.Wu,{className:"p-4",children:[(0,a.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/3 mb-2"}),(0,a.jsx)("div",{className:"h-3 bg-gray-200 rounded w-1/2"})]})},e))})]}):f?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Project Progress"}),(0,a.jsxs)(l.$,{onClick:k,children:[(0,a.jsx)(d.A,{className:"h-4 w-4 mr-2"}),"Add Entry"]})]}),(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("p",{className:"text-red-500 mb-4",children:f}),(0,a.jsx)(l.$,{onClick:k,variant:"outline",children:"Try Again"})]})]}):(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Project Progress"}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:[s.length," entries • ",s.reduce((e,s)=>e+s.hoursWorked,0)," hours • ",s.reduce((e,s)=>e+s.photos.length,0)," photos"]})]}),(0,a.jsxs)(h.lG,{open:N,onOpenChange:v,children:[(0,a.jsx)(h.zM,{asChild:!0,children:(0,a.jsxs)(l.$,{children:[(0,a.jsx)(d.A,{className:"h-4 w-4 mr-2"}),"Add Entry"]})}),(0,a.jsxs)(h.Cf,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,a.jsx)(h.c7,{children:(0,a.jsx)(h.L3,{children:"Add Progress Entry"})}),(0,a.jsx)(C,{apartmentId:e,onSuccess:()=>{v(!1),k()},onCancel:()=>v(!1)})]})]})]}),0===s.length?(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(c.A,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-500 mb-4",children:"No progress entries yet"}),(0,a.jsx)("p",{className:"text-sm text-gray-400",children:"Start logging your daily work progress"})]}):(0,a.jsx)("div",{className:"space-y-4",children:s.map(e=>(0,a.jsxs)(i.Zp,{className:"hover:shadow-md transition-shadow",children:[(0,a.jsx)(i.aR,{className:"pb-3",children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)(i.ZB,{className:"text-base flex items-center gap-2",children:[(0,a.jsx)(c.A,{className:"h-4 w-4"}),(0,p.GP)(new Date(e.date),"PPP")]}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground mt-1 line-clamp-2",children:e.workDescription})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)(n.E,{variant:"outline",children:[(0,a.jsx)(o.A,{className:"h-3 w-3 mr-1"}),e.hoursWorked,"h"]}),e.photos.length>0&&(0,a.jsxs)(n.E,{variant:"outline",children:[(0,a.jsx)(m.A,{className:"h-3 w-3 mr-1"}),e.photos.length]})]})]})}),(0,a.jsx)(i.Wu,{className:"pt-0",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Created ",(0,p.GP)(new Date(e.createdAt),"PPp")]}),(0,a.jsxs)(l.$,{size:"sm",variant:"outline",onClick:()=>D(e),children:[(0,a.jsx)(x.A,{className:"h-4 w-4 mr-1"}),"View Details"]})]})})]},e._id))}),(0,a.jsx)(h.lG,{open:P,onOpenChange:A,children:(0,a.jsxs)(h.Cf,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,a.jsx)(h.c7,{children:(0,a.jsx)(h.L3,{children:"Progress Entry Details"})}),y&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-semibold",children:(0,p.GP)(new Date(y.date),"PPP")}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:[y.hoursWorked," hours worked"]})]}),(0,a.jsxs)(n.E,{variant:"outline",children:[(0,a.jsx)(o.A,{className:"h-3 w-3 mr-1"}),y.hoursWorked,"h"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h5",{className:"font-medium mb-2",children:"Work Description"}),(0,a.jsx)("p",{className:"text-sm whitespace-pre-wrap",children:y.workDescription})]}),y.photos.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("h5",{className:"font-medium mb-2",children:["Photos (",y.photos.length,")"]}),(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:y.photos.map((e,s)=>(0,a.jsx)("img",{src:e,alt:`Progress photo ${s+1}`,className:"w-full h-32 object-cover rounded-md"},s))})]})]})]})})]})}},85910:(e,s,t)=>{t.d(s,{Tabs:()=>n,TabsContent:()=>o,TabsList:()=>d,TabsTrigger:()=>c});var a=t(60687),r=t(43210),l=t(55146),i=t(96241);let n=l.bL,d=r.forwardRef(({className:e,...s},t)=>(0,a.jsx)(l.B8,{ref:t,className:(0,i.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...s}));d.displayName=l.B8.displayName;let c=r.forwardRef(({className:e,...s},t)=>(0,a.jsx)(l.l9,{ref:t,className:(0,i.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...s}));c.displayName=l.l9.displayName;let o=r.forwardRef(({className:e,...s},t)=>(0,a.jsx)(l.UC,{ref:t,className:(0,i.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...s}));o.displayName=l.UC.displayName},86287:(e,s,t)=>{t.d(s,{k:()=>n});var a=t(60687),r=t(43210),l=t(25177),i=t(96241);let n=r.forwardRef(({className:e,value:s,...t},r)=>(0,a.jsx)(l.bL,{ref:r,className:(0,i.cn)("relative h-4 w-full overflow-hidden rounded-full bg-secondary",e),...t,children:(0,a.jsx)(l.C1,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(s||0)}%)`}})}));n.displayName=l.bL.displayName}};